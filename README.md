# Lab SQL Join
```sql
-- Setting the working database
USE sakila;

-- Challenge - Joining on multiple tables
-- Write SQL queries to perform the following tasks using the Sakila database:

-- 1. List the number of films per category.
SELECT c.name, COUNT(f.film_id) AS film_count
FROM category AS c
JOIN film_category AS f
ON c.category_id = f.category_id
GROUP BY c.name;

-- 2. Retrieve the store ID, city, and country for each store.
SELECT s.store_id, city, country
FROM store AS s
INNER JOIN address AS a ON s.address_id = a.address_id
INNER JOIN city AS c ON a.city_id = c.city_id
INNER JOIN country AS co ON c.country_id = co.country_id;

-- 3. Calculate the total revenue generated by each store in dollars.
SELECT s.store_id, COUNT(p.amount) AS total_revenue
FROM store AS s
INNER JOIN customer AS c ON s.store_id = c.store_id
INNER JOIN payment AS p ON c.customer_id = p.customer_id
GROUP BY s.store_id;

-- 4. Determine the average running time of films for each category.
SELECT c.category_id, ROUND(AVG(f.length), 2) AS avg_length
FROM film AS f
INNER JOIN film_category AS fc ON f.film_id = fc.film_id
INNER JOIN category AS c ON fc.category_id = c.category_id
GROUP BY c.category_id;
```
